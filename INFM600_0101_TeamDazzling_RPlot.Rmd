



<b><div align="Centre">
  <font size="5">Team Dazzling</font>
</div><div align="Centre">
 <font size="6">R Plot Draft</font> 
</div>
</b>

Q1. Research Question: Some hospitals claim to have better service and charge more for high quality care, but are patients getting their money's worth?

To analyze this statement, we consider data available in the medical spending file, complications file and the Hospital Consumer Assessment of Healthcare Providers and Systems(HCAHPS) file. For this assignment, we will plot each of the measure variable present in the files to the states of DC and VA. For plotting better services, HCAHPS file and complication file is taken into consideration. For plotting money's worth, we take medical spending file into consideration. 

<p>Figure 1.</p>

```{r message=FALSE}
spending=read.csv(file="C:/Users/Arpit/Desktop/Medicare Hospital Spending by Impatient Claim Type (DC&VA only).xlsx - Sheet1.csv")
#--This is the command to read a csv file in R. X is the variable that stores spendingbyclaim.csv dataset.
spending_sum<-tapply(spending$Avg,list(spending$State),FUN = mean)
barplot(spending_sum, main = "Mean of Spending Per state", xlab = "State", ylab = "Mean of Cost/Episode",ylim = c(0, 20000), names.arg = c("DC", "VA"))
```

<p>In the above figure, we have plotted mean of spending per episode at hospital to the states. Spending per episode indicates the total cost of the entire episode at the hospital. We have taken mean as the number of hospitals in Virginia is more than in DC. The t-apply command helps us group the spending per episode for VA and DC. From the bar plot we can see that, spending per episode is higher in DC than in Virginia. This cost difference is due to the location.</p>


<p>Figure 2.</p>
<p>For the next plot we need to install the packages "ggplot2","reshape","extraplot"and"xkcd". We install the packages first, if they aren't present already and to use the packages we use the library command. We use the packages to improve the display of the graphs. The below script contains t-apply command which groups the rating by measure name and state. The melt command helps reshape the data for plotting. The xkcd fonts are added to this plot using the font import command. For better presentation, we flip the axes using the coordinate flip command. To label the x and y axes and chart titles we use the xlab,ylab and ggtitle command in R. </p>

```{r message=FALSE}
#install.packages("ggplot2")
#install.packages("reshape")
#install.packages("extrafont")
#install.packages("xkcd")
library(ggplot2)
library(reshape)
library(extrafont)
hcahps=read.csv(file="C:/Users/Arpit/Desktop/HCAHPS.csv")
counts_sum<-tapply(hcahps$Patient.Survey.Star.Rating,list(hcahps$State,hcahps$HCAHPS.Measure.ID),FUN = mean)
#grouping by state
Names= c("VA","DC")
data.sum<- melt(counts_sum,id.vars='Names')
#Melting to reshape the data
colnames(data.sum) = c("state","variable","value")
font_import(pattern = "[X/x]kcd", prompt = FALSE)
#xkcd command for font
fonts()
loadfonts(device = "win")
ggplot(data.sum,aes(x=variable,y=value,width=0.75))  + geom_bar(stat="identity",aes(fill=state),position="dodge") + ggtitle("HCAHPS") + xlab("Measure_Names")+ylab("Ratings")+ coord_flip() + theme(text=element_text(family = "xkcd"))
#ggplot command
```
<p>From the above figure, we can see various measure rating in the y axes for quality in both the states. The value in x axes is from the range of 0 to 5, 0 being low and 5 being high. The important measure rating to consider are the cleaniness rating and the quiet rating. We have taken the mean rating for each state. As we can see from the above figure, Virginia offers better quality measures than DC.  </p>



<p>Figure 3.</p>

<p>For the next plot we need to install the packages "ggplot2","reshape","extraplot"and"xkcd". We install the packages first, if they aren't present already and to use the packages we use the library command. We use the packages to improve the display of the graphs. The below script contains t-apply command which groups the score by measure name and state. The melt command helps reshape the data for plotting. The xkcd fonts are added to this plot using the font import command. For better presentation, we flip the axes using the coordinate flip command. To label the x and y axes and chart titles we use the xlab,ylab and ggtitle command in R. </p>

```{r message=FALSE}
#install.packages("ggplot2")
#install.packages("reshape")
#install.packages("extrafont")
#install.packages("xkcd")
library(ggplot2)
library(reshape)
library(extrafont)
complications=read.csv(file="C:/Users/Arpit/Desktop/clean_complications-data.xlsx - Sheet1.csv")
complications_mean<-tapply(complications$Score,list(complications$State,complications$MeasureName),FUN = mean)
Names= c("VA","DC")
data.sum<- melt(complications_mean,id.vars='Names')
colnames(data.sum) = c("state","variable","score")
font_import(pattern = "[X/x]kcd", prompt = FALSE)
fonts()
loadfonts(device = "win")
ggplot(data.sum,aes(x=variable,y=score,width=0.75))  + geom_bar(stat="identity",aes(fill=state),position="dodge") + ggtitle("Complications in Hospital") + xlab("Measure_Names")+ylab("Score")+ theme(text=element_text(family = "xkcd"))
```

<p>Complication which occur at the hospital are another variable we consider for better service.This data is of the Healthcare Associated Infection, meaning the infections caused during admission. So the lower the score is for each of the measure the better we would consider the service of the hospital.So here we can see that Virginia gets a lower score than DC. Making the quality of service offered by hospitals at Virginia better.Here the parameters we measure are Accidental cuts and tears from medical treatment, Deaths among Patients with Serious Treatable Complications after Surgery and Serious complications  </p>





Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).
